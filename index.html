<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayu Winda - Cinematic Birthday üíñ</title>
    <style>
        :root {
            --primary-pink: #ff477e;
            --premium-glow: rgba(255, 71, 126, 0.5);
        }

        body { 
            margin: 0; 
            overflow: hidden; 
            background: radial-gradient(circle at center, #1a0a1a 0%, #000000 100%);
            font-family: 'Segoe UI', Roboto, sans-serif;
        }

        canvas { display: block; }

        /* Nebula Gradient Background */
        #nebula-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 71, 126, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(71, 126, 255, 0.1) 0%, transparent 40%);
            z-index: -1;
            filter: blur(50px);
            animation: nebulaMove 20s infinite alternate ease-in-out;
        }

        @keyframes nebulaMove {
            0% { transform: scale(1); opacity: 0.5; }
            100% { transform: scale(1.2); opacity: 0.8; }
        }

        /* Shooting Star Effect */
        .star {
            position: absolute;
            top: -2px;
            width: 2px;
            height: 2px;
            background: #fff;
            border-radius: 50%;
            opacity: 0;
            z-index: -1;
            box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.5);
            animation: shootingStar 3s linear infinite;
        }

        .star::after {
            content: '';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 1px;
            background: linear-gradient(90deg, #fff, transparent);
        }

        @keyframes shootingStar {
            0% { transform: translateX(0) translateY(0) rotate(-45deg); opacity: 0; }
            10% { opacity: 1; }
            70% { opacity: 1; }
            100% { transform: translateX(-800px) translateY(800px) rotate(-45deg); opacity: 0; }
        }

        /* Modern Clean UI */
        #ui-panel {
            position: absolute;
            top: 30px; left: 30px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            padding: 25px;
            border-radius: 20px;
            color: white;
            z-index: 100;
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 260px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h3 { margin: 0 0 20px 0; font-weight: 300; letter-spacing: 2px; font-size: 18px; text-align: center; }

        .control-group { margin-bottom: 20px; }
        label { display: block; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; opacity: 0.6; }
        
        select, input { 
            width: 100%; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); 
            color: white; padding: 10px; border-radius: 8px; outline: none; transition: 0.3s;
        }

        .btn-flex {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        button.main-btn {
            width: 100%; background: var(--primary-pink); border: none; color: white;
            padding: 12px; border-radius: 10px; cursor: pointer; font-weight: 600;
            letter-spacing: 1px; transition: 0.3s; box-shadow: 0 4px 15px var(--premium-glow);
        }

        button.music-btn {
            width: 50px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: white; border-radius: 10px; cursor: pointer; font-size: 18px; transition: 0.3s;
        }

        button.main-btn:hover, button.music-btn:hover { transform: translateY(-2px); filter: brightness(1.2); }

        /* Elegant Fade Message */
        #message-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex; justify-content: center; align-items: center;
            z-index: 200; opacity: 0; visibility: hidden;
            transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #message-overlay.active { opacity: 1; visibility: visible; }

        #message-box {
            background: transparent;
            padding: 40px;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            color: white;
            text-align: center;
            line-height: 1.8;
            transform: translateY(30px);
            transition: 1.2s transform cubic-bezier(0.4, 0, 0.2, 1);
        }

        #message-overlay.active #message-box { transform: translateY(0); }

        .close-btn { 
            margin-top: 30px; background: transparent; border: 1px solid rgba(255,255,255,0.3); 
            color: white; padding: 10px 30px; border-radius: 50px; cursor: pointer; 
        }

        #fullscreen-btn {
            position: absolute; bottom: 30px; right: 30px;
            background: rgba(255,255,255,0.1); border: none; color: white;
            width: 45px; height: 45px; border-radius: 50%; cursor: pointer;
        }

        /* Custom Scrollbar */
        #message-box::-webkit-scrollbar { width: 5px; }
        #message-box::-webkit-scrollbar-thumb { background: var(--primary-pink); border-radius: 10px; }
    </style>
</head>
<body>

    <div id="nebula-bg"></div>
    <div id="stars-container"></div>

    <div id="ui-panel">
        <h3>AYU WINDA</h3>
        <div class="control-group">
            <label>Visual Pattern</label>
            <select id="pattern-select">
                <option value="heart">üíñ Glowing Heart</option>
                <option value="text">‚ú® Birthday Text</option>
                <option value="sphere" selected>üåå Galaxy Sphere</option>
                <option value="cube">üì¶ Prism Cube</option>
            </select>
        </div>
        <div class="control-group">
            <label>Particle Glow</label>
            <input type="color" id="color-picker" value="#ff477e">
        </div>
        
        <button class="main-btn" onclick="openMessage()">Buka Pesan Rahasia üíå</button>
        
        <div class="btn-flex">
            <button class="music-btn" id="music-toggle" onclick="toggleMusic()">üîá</button>
            <p style="font-size: 10px; opacity: 0.6; margin: auto 0;">Ketuk untuk Musik</p>
        </div>
    </div>

    <div id="message-overlay">
        <div id="message-box">
            <h1 style="color: var(--primary-pink); font-weight: 300; margin-bottom: 30px;">Selamat Ulang Tahun, Sayang üíñ</h1>
            <div style="font-size: 16px; opacity: 0.9;">
                <p>"Selamat ulang tahun sayangkuuu, cintakuuu ü•∞‚ú®</p>
                <p>Di hari spesial ini, aku cuma mau bilang‚Ä¶ aku bersyukur banget Tuhan menghadirkan kamu di hidupku. Kamu bukan hanya seseorang yang aku cintai, tapi juga rumah ternyaman tempat aku pulang, tempat aku bercerita, dan tempat aku menemukan ketenangan.</p>
                <p>Terima kasih sudah selalu bertahan bersamaku, menerima aku dengan segala kekurangan, dan tetap memilih aku sampai hari ini. Semoga kamu makin sayang sama aku, makin cinta sama aku, dan hati kita selalu saling memilih hari ini, besok, dan selamanya üíç</p>
                <p>Semoga semua mimpi kamu tercapai, langkahmu selalu dimudahkan, rezekimu dilancarkan, dan hatimu selalu dijaga bahagia. Aku bangga punya kamu, dan aku beruntung bisa mencintai kamu.</p>
                <p>Maafin aku ya sayang‚Ä¶ aku cuma bisa kasih kejutan sederhana ini. Dan maaf juga di ulang tahun kamu kali ini aku belum bisa hadir di samping kamu. Tapi percayalah, hati aku tetap ada di dekat kamu, selalu.</p>
                <p>Dan ada satu hal lagi‚Ä¶</p>
                <p style="font-style: italic; color: var(--primary-pink);">Tahun depan, di ulang tahun kamu yang ke-25, semoga kita sudah merayakannya bersama keluarga kecil kita sendiri, tertawa di rumah kita, dengan anak-anak kita yang berlarian. Hehe‚Ä¶ aku ngebayanginnya aja sudah bahagia ü§ç</p>
                <p>Aku sayang kamu‚Ä¶ hari ini lebih dari kemarin, dan besok lebih dari hari ini.</p>
                <p>I love you so much, sayang.</p>
                <p>Selamat bertambah usia, <b>Gusti Ayu Winda Setiawati</b> üíñ</p>
                <p style="font-size: 24px;">Muah üòò</p>
            </div>
            <button class="close-btn" onclick="closeMessage()">Kembali ke Partikel</button>
        </div>
    </div>

    <button id="fullscreen-btn" onclick="toggleFullscreen()">‚õ∂</button>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';

        let scene, camera, renderer, particles, font;
        const particleCount = 20000;
        let positions = [];
        let targetPositions = [];
        let isInteracting = false;
        let mouse = new THREE.Vector2(-100, -100);
        let raycaster = new THREE.Raycaster();
        
        // Setup Audio
        let audio = new Audio('musik/bg_music.mp3'); // Ganti dengan path musik yang diinginkan
        audio.loop = true;
        let isMusicPlaying = false;

        function createStars() {
            const container = document.getElementById('stars-container');
            setInterval(() => {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * window.innerWidth + 'px';
                star.style.top = Math.random() * (window.innerHeight / 2) + 'px';
                star.style.animationDuration = (Math.random() * 2 + 1) + 's';
                container.appendChild(star);
                setTimeout(() => star.remove(), 3000);
            }, 2000);
        }

        init();
        animate();
        createStars();

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 6;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.body.appendChild(renderer.domElement);

            const loader = new FontLoader();
            loader.load('https://unpkg.com/three@0.160.0/examples/fonts/helvetiker_bold.typeface.json', (f) => {
                font = f;
                updatePattern('sphere'); 
            });

            const sprite = new THREE.TextureLoader().load('https://threejs.org/examples/textures/sprites/disc.png');

            const geometry = new THREE.BufferGeometry();
            for (let i = 0; i < particleCount; i++) {
                positions.push((Math.random() - 0.5) * 12);
                positions.push((Math.random() - 0.5) * 12);
                positions.push((Math.random() - 0.5) * 12);
                targetPositions.push(positions[i*3], positions[i*3+1], positions[i*3+2]);
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            
            const material = new THREE.PointsMaterial({
                size: 0.04,
                color: 0xff477e,
                transparent: true,
                blending: THREE.AdditiveBlending,
                map: sprite,
                depthWrite: false,
                opacity: 0.8
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            window.addEventListener('resize', onWindowResize);
            window.addEventListener('mousemove', (e) => {
                mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            });
            
            // Klik layar juga mengaktifkan interaksi partikel
            window.addEventListener('mousedown', () => isInteracting = true);
            window.addEventListener('mouseup', () => isInteracting = false);
            window.addEventListener('touchstart', (e) => { isInteracting = true; handleTouch(e); });
            window.addEventListener('touchend', () => isInteracting = false);

            document.getElementById('color-picker').addEventListener('input', (e) => particles.material.color.set(e.target.value));
            document.getElementById('pattern-select').addEventListener('change', (e) => updatePattern(e.target.value));
        }

        function updatePattern(type) {
            const temp = [];
            if (type === 'sphere') {
                for (let i = 0; i < particleCount; i++) {
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(Math.random() * 2 - 1);
                    temp.push(2.8 * Math.sin(phi) * Math.cos(theta), 2.8 * Math.sin(phi) * Math.sin(theta), 2.8 * Math.cos(phi));
                }
            } else if (type === 'cube') {
                for (let i = 0; i < particleCount; i++) {
                    temp.push((Math.random() - 0.5) * 4.5, (Math.random() - 0.5) * 4.5, (Math.random() - 0.5) * 4.5);
                }
            } else if (type === 'heart') {
                for (let i = 0; i < particleCount; i++) {
                    const t = Math.random() * Math.PI * 2;
                    const x = 16 * Math.pow(Math.sin(t), 3);
                    const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
                    temp.push(x * 0.18, y * 0.18, (Math.random() - 0.5) * 1.5);
                }
            } else if (type === 'text' && font) {
                const textGeo = new TextGeometry("HAPPY BDAY", { font: font, size: 0.5, height: 0.1 });
                textGeo.center();
                const pts = textGeo.attributes.position.array;
                for (let i = 0; i < particleCount; i++) {
                    const i3 = (i % (pts.length / 3)) * 3;
                    temp.push(pts[i3], pts[i3+1], pts[i3+2] + (Math.random()-0.5)*0.3);
                }
            }
            targetPositions = temp;
        }

        function animate() {
            requestAnimationFrame(animate);
            const posAttr = particles.geometry.attributes.position;
            raycaster.setFromCamera(mouse, camera);
            const interactPoint = new THREE.Vector3();
            raycaster.ray.at(5, interactPoint);

            for (let i = 0; i < particleCount; i++) {
                const i3 = i * 3;
                let x = posAttr.array[i3], y = posAttr.array[i3+1], z = posAttr.array[i3+2];
                const tx = targetPositions[i3], ty = targetPositions[i3+1], tz = targetPositions[i3+2];

                x += (tx - x) * 0.04; y += (ty - y) * 0.04; z += (tz - z) * 0.04;

                if (isInteracting) {
                    const dx = interactPoint.x - x, dy = interactPoint.y - y, dz = interactPoint.z - z;
                    const dist = Math.sqrt(dx*dx + dy*dy + dz*dz);
                    if (dist < 2.5) { x += dx * 0.09; y += dy * 0.09; z += dz * 0.09; }
                }
                posAttr.array[i3] = x; posAttr.array[i3+1] = y; posAttr.array[i3+2] = z;
            }
            posAttr.needsUpdate = true;
            particles.rotation.y += 0.0015;
            renderer.render(scene, camera);
        }

        function handleTouch(e) {
            if(e.touches.length > 0) {
                mouse.x = (e.touches[0].clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(e.touches[0].clientY / window.innerHeight) * 2 + 1;
            }
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Global functions
        window.toggleMusic = function() {
            const btn = document.getElementById('music-toggle');
            if (!isMusicPlaying) {
                audio.play();
                btn.innerHTML = "üîä";
                isMusicPlaying = true;
            } else {
                audio.pause();
                btn.innerHTML = "üîá";
                isMusicPlaying = false;
            }
        };

        window.openMessage = () => document.getElementById('message-overlay').classList.add('active');
        window.closeMessage = () => document.getElementById('message-overlay').classList.remove('active');
        window.toggleFullscreen = () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        };
    </script>
</body>
</html>